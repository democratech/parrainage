{% extends 'base.html' %}
{% block page-content %}
<div class="introduction">
    <div class="container">
        <p class="lead m-b-4">Ce service permet de coordonner la recherche des parrainages pour Charlotte Marchandise.</p>
    </div>
</div>
<div class="container">
    <h3>Rechercher un élu</h3>
    <div>
	<form action="{% url 'elu-list' %}" method="GET" class="form-inline">
	    <input type="text" class="form-control" name="search" placeholder="Nom ou ville de l'élu">
	    <button type="submit" class="btn btn-primary">Rechercher</button>
	</form>
    </div>
    <p></p>
    <h3>Consulter les élus d'un département</h3>
    <div>
	<form action="{% url 'elu-list' %}" method="GET" class="form-inline">
	    <div class="form-group">
		<label for="department">Département:</label>
		<select class="form-control" name="department" id="department">
		    {% for d in departements %}
		    <option>{{ d }}</option>
		    {% endfor %}
		</select>
	    </div>
	    <div class="form-group">
		<label for="sort">Trier par:</label>
		<select class="form-control" name="sort" id="sort">
		    <option value="priority">Priorité</option>
		    <option value="">Ordre alphabétique</option>
		    {% if user.is_authenticated %}
		    <option value="status">Statut</option>
		    {% endif %}
		</select>
	    </div>
	    <button type="submit" class="btn btn-primary">Voir les élus</button>
	</form>
    </div>
    <p></p>
    <h3>Liens utiles</h3>
    <ul>
	<li><a href="https://umap.openstreetmap.fr/fr/map/carte-des-parrainages_126228#6/46.875/6.548">Carte des élus</a> : identifiez les élus près de chez vous qu'il reste à contacter.</li>
	<li><a href="http://charlotte-marchandise.fr/chamawiki/doku.php?id=public:parrainages">Explications et conseils pour démarcher les élus</a></li>
	<li><a href="http://charlotte-marchandise.fr/parrainage/">Le kit parrainage</a></li>
    </ul>
    <p></p>
    {% if user.is_authenticated %}
    <h3>Mes élus à gérer</h3>
    <table class="table table-sm table-striped">
	<tr>
	    <th>#</th>
	    <th>Élu</th>
	    <th>Statut</th>
	    <th>Dernière mise à jour</th>
	</tr>
	{% for elu in my_elus %}
	<tr>
	    <td>{{ forloop.counter }}</td>
	    <td><a href="{{ elu.get_absolute_url }}">{{ elu }}</a></td>
	    <td>{{ elu.get_status_display }}</td>
	    <td>{{ elu.last_updated }} (il y a {{ elu.last_updated|timesince }})</td>
	</tr>
	{% endfor %}
    </table>
    <p></p>
    {% endif %}
    <h3>Statistiques</h3>
    <ul>
	{% if user.is_authenticated %}
	<li>{{ user_count }} bénévoles ont contacté {{ elus_contacted }}
	    élus parmi lesquels {{ elus_accepted }} ont donné leur
	    parrainage, {{ elus_refused }} ont refusé (il y a donc
	    {{ elus_in_process }} élus n'ayant pas encore répondu).</li>
	<li><a href="{% url 'department-ranking' %}">Classement des
		départements</a></li>
	<li><a href="{% url 'user-ranking' %}">Classement des
		utilisateurs</a></li>
	{% else %}
	<li>{{ user_count }} bénévoles ont contacté {{ elus_contacted }}
	    élus. Des statistiques plus détaillées sont disponibles
	    une fois connecté.
	</li>

	{% endif %}
    </ul>
</div>
{% endblock %}
